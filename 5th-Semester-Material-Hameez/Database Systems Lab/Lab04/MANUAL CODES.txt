SELECT AVG(SALARY) AS "AVERAGE_SALARY", DEPARTMENT_ID
FROM EMPLOYEES GROUP BY DEPARTMENT_ID;

SELECT AVG(SALARY) FROM EMPLOYEES;

SELECT * FROM EMPLOYEES WHERE DEPARTMENT_ID = 60;

display department wise average salary return department id, job_id in the result too.
SELECT DEPARTMENT_ID, AVG(SALARY), JOB_ID FROM EMPLOYEES GROUP BY DEPARTMENT_ID, JOB_Id;

select * from employees;

SELECT DEPARTMENT_ID, AVG(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID HAVING AVG(SALARY)>3000;

--DISPLAY SALARY DEPARTMENT WISE JISKA TOTAL SUM > 1500
SELECT SUM(SALARY) AS "TOTAL SALARY", DEPARTMENT_ID FROM EMPLOYEES GROUP BY DEPARTMENT_ID HAVING SUM(SALARY) > 1500;


--JOHN KI SALARY SE ZAYADA JIN KI BHI SALARY HAI PRINT KRWAO
SELECT * FROM EMPLOYEES WHERE SALARY >
(SELECT SALARY FROM EMPLOYEES WHERE EMPLOYEE_ID = 105);

SELECT * FROM EMPLOYEES WHERE SALARY >
(SELECT MAX(SALARY) FROM EMPLOYEES WHERE EMPLOYEE_ID =
(SELECT EMPLOYEE_ID FROM EMPLOYEES WHERE FIRST_NAME = 'JOHN')
);

SELECT * FROM EMPLOYEES WHERE FIRST_NAME IN ('Lex','Steven');
SELECT * FROM JOBS;

SELECT FIRST_NAME, JOB_ID FROM EMPLOYEES WHERE JOB_ID = 'PU_CLERK';

SELECT FIRST_NAME, JOB_ID FROM EMPLOYEES WHERE JOBS.JOB_TITLE = 'President';

SELECT FIRST_NAME, JOB_ID FROM EMPLOYEES
WHERE JOB_ID =
(SELECT JOB_ID FROM JOBS WHERE JOB_ID = 'PU_CLERK');

SELECT * FROM EMPLOYEES WHERE SALARY =
(SELECT MAX(SALARY) FROM EMPLOYEES);

SELECT * FROM EMPLOYEES WHERE SALARY >
(SELECT AVG(SALARY) FROM EMPLOYEES);

--Show the name and dept_ID of all employees having location_ID=1700
SELECT FIRST_NAME, DEPARTMENT_ID FROM EMPLOYEES
WHERE DEPARTMENT_ID IN
(SELECT DEPARTMENT_ID FROM DEPARTMENTS WHERE LOCATION_ID = 1700);

--ANY:
SELECT FIRST_NAME, EMPLOYEE_ID, JOB_ID FROM EMPLOYEES
WHERE SALARY < ANY
(SELECT SALARY FROM EMPLOYEES WHERE JOB_ID = 'PU_CLERK');

--CHECK FROM VIEW
SELECT department_name, avg(salary)
FROM EMP_DETAILS_VIEW
GROUP BY department_name
HAVING avg(salary) >
(SELECT avg(salary) FROM EMPLOYEES);


************************
--create a replica of the employee table and jobs table me se accountant title match krke unki job ids extract karo and unhein employee table me se nikal ke replica table me insert kardo

CREATE TABLE REP_EMPLOYEE AS SELECT * FROM hr.EMPLOYEES WHERE 1=2;

DESC REP_EMPLOYEE;

INSERT INTO REP_EMPLOYEE
SELECT * FROM hr.EMPLOYEES WHERE JOB_ID IN
(SELECT JOB_ID FROM hr.JOBS WHERE JOB_TITLE = 'Accountant');

select * from rep_employee;




UPDATE REP_EMPLOYEE
SET SALARY = SALARY+(0.1*SALARY)
WHERE JOB_ID IN
(SELECT JOB_ID FROM hr.JOBS WHERE MIN_SALARY = 3000);